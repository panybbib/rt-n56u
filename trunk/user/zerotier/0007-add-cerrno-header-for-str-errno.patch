From e06177a74f1e4314baf17c52f360dabcb78e69cd Mon Sep 17 00:00:00 2001
From: Moritz Warning <moritzwarning@web.de>
Date: Sun, 29 Nov 2020 19:45:36 +0100
Subject: [PATCH 7/8] add cerrno header for (str)errno

Fixes compilation under libcxx.

Signed-off-by: Rosen Penev <rosenp@gmail.com>
---
 osdep/LinuxNetLink.cpp | 2 ++
 1 file changed, 2 insertions(+)

--- a/osdep/LinuxNetLink.cpp
+++ b/osdep/LinuxNetLink.cpp
@@ -24,6 +24,8 @@
 #include <unistd.h>
 #include <linux/if_tun.h>
 
+#include <cerrno>
+
 #ifndef IFNAMSIZ
 #define IFNAMSIZ 16
 #endif
@@ -291,7 +293,7 @@
 	char gws[40] = {0};
 	char srcs[40] = {0};
 	char ifs[16] = {0};
-	char ms[24] = {0};
+	//char ms[24] = {0};
 
 	struct rtmsg *rtp = (struct rtmsg *)NLMSG_DATA(nlp);
 	struct rtattr *rtap = (struct rtattr *)RTM_RTA(rtp);
@@ -367,10 +369,10 @@
 		_routes[r.target].insert(r);
 	}
 
-#ifdef ZT_NETLINK_TRACE
-	sprintf(ms, "%d", rtp->rtm_dst_len);
-	fprintf(stderr, "Route Added: dst %s/%s gw %s src %s if %s\n", dsts, ms, gws, srcs, ifs);
-#endif
+//#ifdef ZT_NETLINK_TRACE
+//	sprintf(ms, "%d", rtp->rtm_dst_len);
+//	fprintf(stderr, "Route Added: dst %s/%s gw %s src %s if %s\n", dsts, ms, gws, srcs, ifs);
+//#endif
 }
 
 void LinuxNetLink::_routeDeleted(struct nlmsghdr *nlp)
@@ -379,7 +381,7 @@
 	char gws[40] = {0};
 	char srcs[40] = {0};
 	char ifs[16] = {0};
-	char ms[24] = {0};
+	//char ms[24] = {0};
 
 	struct rtmsg *rtp = (struct rtmsg *) NLMSG_DATA(nlp);
 	struct rtattr *rtap = (struct rtattr *)RTM_RTA(rtp);
@@ -455,10 +457,10 @@
 		_routes[r.target].erase(r);
 	}
 
-#ifdef ZT_NETLINK_TRACE
-	sprintf(ms, "%d", rtp->rtm_dst_len);
-	fprintf(stderr, "Route Deleted: dst %s/%s gw %s src %s if %s\n", dsts, ms, gws, srcs, ifs);
-#endif
+//#ifdef ZT_NETLINK_TRACE
+//	sprintf(ms, "%d", rtp->rtm_dst_len);
+//	fprintf(stderr, "Route Deleted: dst %s/%s gw %s src %s if %s\n", dsts, ms, gws, srcs, ifs);
+//#endif
 }
 
 void LinuxNetLink::_linkAdded(struct nlmsghdr *nlp)
